<div class="readme-block">
  <div>
    <style>
      @import url(/_upload/tpl/0c/d8/3288/template3288/css/github.css);
    </style>
    <h1 id="abacuswannier90interface">ABACUS-wannier90 interface</h1>
    <p><a href="../../README.html">back to main page</a></p>
    <p>
      <a href="http://www.wannier.org">Wannier90</a> is a useful package to
      calculate the maximally-localized Wannier functions (MLWFs) [15] and
      related quantities. ABACUS provides an interface to Wannier90 package. The
      users are assumed to be familiar with the use of Wannier90. To construct
      the MLWFs using the wave functions of ABACUS generally requires four
      steps. Here we use the diamond as an example.
    </p>
    <p>
      This example can be found in
      examples/wannier90-example/ABACUS_towannier90/.
    </p>
    <p>
      First, you need prepare a Wannier90 input file, e.g., âdiamond.winâ, which
      is the master input file for Wannier90. It contains the specification of
      the system and any parameters for the run. You should run âwannier90 -pp
      diamond.winâ to generate âdiamond.nnkpâ file which will be read in by
      ABACUS later.
    </p>
    <pre><code>num_wann = 4
num_iter = 20
wvfn_formatted = .true.
begin atoms_frac
C -0.12500 -0.1250 -0.125000
C 0.12500 0.1250 0.125000
end atoms_frac
begin projections
f=0.0,0.0,0.0:s
f=0.0,0.0,0.5:s
f=0.0,0.5,0.0:s
f=0.5,0.0,0.0:s
end projections
begin unit_cell_cart
-1.613990 0.000000 1.613990
0.000000 1.613990 1.613990
-1.613990 1.613990 0.000000
end unit_cell_cart
mp_grid : 4 4 4
begin kpoints
0.0000 0.0000 0.0000
0.0000 0.2500 0.0000
...
end kpoints
</code></pre>
    <p>
      Second, do a self-consistent calculation as described in Sec. 4.6.1 and
      get the converged charge density. Third, do a non-self-consistent
      calculation. You should setup the ABACUS INPUT parameters and KPT file
      according to the âdiamond.winâ file. The ABACUS INPUT file and KPT file
      for the nscf calculation for the fifth example (diamond) in the Wannier90
      package are given below.
    </p>
    <pre><code>INPUT_PARAMETERS
ntype 1
ecutwfc 40
nbands 4 ! number of bands
calculation nscf ! non-self-consistent calculation
scf_nmax 40
pw_diag_thr 1.0e-8
scf_thr 1.0e-8
init_chg file ! read charge from files
#Parameters(wannier90)
towannier90 1 ! use the ABACUS-wannier90 interface
nnkpfile diamond.nnkp ! specify .nnkp file
</code></pre>
    <pre><code>K_POINTS
64
Direct
0.0000 0.0000 0.0000 0.0156250
0.0000 0.2500 0.0000 0.0156250
0.0000 0.5000 0.0000 0.0156250
0.0000 0.7500 0.0000 0.0156250
0.2500 0.0000 0.0000 0.0156250
0.2500 0.2500 0.0000 0.0156250
0.2500 0.5000 0.0000 0.0156250
0.2500 0.7500 0.0000 0.0156250
0.5000 0.0000 0.0000 0.0156250
0.5000 0.2500 0.0000 0.0156250
0.5000 0.5000 0.0000 0.0156250
0.5000 0.7500 0.0000 0.0156250
...
</code></pre>
    <p>Here, we have two parameters:</p>
    <ul>
      <li>
        towannier90 : 1, generate files for wannier90 code; 0, do not generate.
      </li>
      <li>
        nnkpfile : the name of the .nnkp file If you use nspin=2, there is one
        additional parameter in the INPUT:
      </li>
      <li>
        wannier_spin : up, calculate the Wannier functions for the spin up
        components ; down, calculate the Wannier functions spin down components.
      </li>
    </ul>
    <p>
      After the nscf calculation, ABACUS will generate âdiamond.amnâ,
      âdiamond.mmnâ, âdiamond.eigâ, âUNK<em>â files in the OUT.</em> folder.
      Finally, you should run âwannier90 diamond.winâ, to get the MLWFs.
    </p>
    <p>Notes:</p>
    <ul>
      <li>
        The ABACUS-wannier90 interface can be used in both pw and lcao basis.
      </li>
      <li>
        You must set âwvfn_formatted = .true.â in âdiamond.winâ, otherwise
        Wannier90 code cannot read files generated by ABACUS because these files
        are not binary files.
      </li>
    </ul>
    <p><a href="#abacus-wannier90-interface">back to top</a></p>
  </div>
</div>
